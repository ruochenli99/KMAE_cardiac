
import pandas as pd
df = pd.read_csv('results.csv')

selected_eid = df[~((df['2178-0.0'] == 3.0) | (df['2178-0.0'] == 4.0) |
                    (df['2178-1.0'] == 3.0) | (df['2178-1.0'] == 4.0) |
                    (df['2178-2.0'] == 3.0) | (df['2178-2.0'] == 4.0) |
                    (df['2178-3.0'] == 3.0) | (df['2178-3.0'] == 4.0)) &
                    (df['22506-0.0'] == 114) &(df['6150-0.0'] == -7) &
                    df['130792-0.0'].isnull() &
                    df[['6150-0.1', '6150-0.2', '6150-0.3', '6150-1.0', '6150-1.1', '6150-1.2', '6150-1.3', '6150-2.0', '6150-2.1', '6150-2.2', '6150-2.3']].apply(lambda x: (x == -7) | x.isnull()).all(axis=1)
                  &(df[['2443-0.0', '2443-1.0', '2443-2.0', '2443-3.0']].apply(lambda x: (x == 0) | x.isnull()).all(axis=1))
                  &(df[['130706-0.0', '130708-0.0', '130710-0.0', '130712-0.0', '130714-0.0']].isnull().all(axis=1))
                  &df[['131298-0.0', '42000-0.0']].isnull().all(axis=1)
&(df.loc[:, '20003-0.0':'20003-0.47'].isna().all(axis=1)) &
                    (df.loc[:, '20003-1.0':'20003-1.47'].isna().all(axis=1)) &
                    (df.loc[:, '20003-2.0':'20003-2.47'].isna().all(axis=1)) &
                    (df.loc[:, '20003-3.0':'20003-3.47'].isna().all(axis=1))
]

print(selected_eid)
selected_eid['eid'].to_csv('health.txt', index=False, header=False)